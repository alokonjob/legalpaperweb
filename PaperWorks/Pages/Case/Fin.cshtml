@page
@model PaperWorks.FinModel
@{
    ViewData["Title"] = "Fin";
    Layout = "~/Pages/Shared/_Layout.cshtml";
}

    <section id="finSection">
        @if (Model.IsNudgeOn)
        {
            <div class="progress">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div>
            </div>
        }
        <h4 class="display-4 m-3 text-muted text-center" data-aos="fade-left" data-aos-delay="800">@Model.ConsultantEmail - Receipt  @Model.Receipt </h4>
        <h4 class="display-4 m-3 text-muted text-center" data-aos="fade-left" data-aos-delay="800">Paid @Model.PaidSoFar out of @Model.FinalizedCost </h4>
        @if (Model.IsNudgeOn)
        {
    <h4 class="display-4 m-3 text-danger text-center" data-aos="fade-left" data-aos-delay="800">Nudged For @Model.NudgeInfo.Amount By @Model.NudgeInfo.CreatedBy On  @Model.NudgeInfo.NudgeOnDate.ToShortDateString()</h4>   
        }

    </section>
<div class="row">
    <div class="col">
        <form class="form m-3" asp-page-handler="ReleasePayment" method="post">
            @*data-ajax="true" data-ajax-method="post"*@


            <div class="form-group">
                <label asp-for="@Model.PostAPayment.PaymentComments"></label>
                <input asp-for="@Model.PostAPayment.PaymentComments" class="form-control" />
                <span asp-validation-for="@Model.PostAPayment.PaymentComments" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="@Model.PostAPayment.PaymentIdentifier"></label>
                <input asp-for="@Model.PostAPayment.PaymentIdentifier" class="form-control" />
                <span asp-validation-for="@Model.PostAPayment.PaymentComments" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="@Model.PostAPayment.Payment"></label>
                <input asp-for="@Model.PostAPayment.Payment" class="form-control" />
                <span asp-validation-for="@Model.PostAPayment.Payment" class="text-danger"></span>
            </div>
            <input type="hidden" asp-for="@Model.Receipt" class="form-control" />
            <input type="hidden" asp-for="@Model.ConsultantEmail" class="form-control" />
            @if (Model.IsNudgeOn)
            {
                <button type="submit" class="btn btn-primary ml-2"> Update Payment And Nudge</button>
            }
            else
            { 
                <button type="submit" class="btn btn-primary ml-2">Update Payment</button>
            }

            <div asp-validation-summary="All" class="text-danger"></div>
        </form>
    </div>
</div>

<div class="caseUpdateList mt-2">
    <partial name="_PayUpdates" model="Model.FullPayInfo" />
</div>


@section Scripts{
    <partial name="_ValidationScriptsPartial" />
    <script type="text/javascript">
        $(document).ready(function () {
            $("#finSection").css("margin-top", $("#topnavbarbutnobeer").height() * 1.3);
        });
    </script>
    <script src="~/lib/jquery-ajax-unobtrusive/jquery.unobtrusive-ajax.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#payUpdatesTable').DataTable();
        });
    </script>
}

