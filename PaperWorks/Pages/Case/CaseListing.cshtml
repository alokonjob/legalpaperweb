@page "{userEmail?}"
@using Microsoft.Extensions.Localization;
@inject IStringLocalizer<CaseListingModel> localizer
@model PaperWorks.CaseListingModel
@{
    ViewData["Title"] = "CaseListing";
    Layout = "~/Pages/Shared/_Layout.cshtml";
    var requestCultureFeature = HttpContext.Features.Get<IRequestCultureFeature>();
    var requestCulture = requestCultureFeature.RequestCulture;
}

<section id="caseListSection">
    <h4 class="display-4 m-3 text-muted text-center" data-aos="fade-left" data-aos-delay="800">case List</h4>
</section>


<table class="table table-striped table-bordered dt-responsive nowrap" id="caseList" style="width:100%">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].ClientCase.Order.ServiceName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].ClientCase.Order.City)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].ClientCase.Order.CustomerEmail)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].ClientCase.Order.CustomerPhone)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].ClientCase.Order.Receipt)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].ClientCase.Order.ConsultantEmail)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].ClientCase.Order.ConsultantPhone)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].ClientCase.Order.CostToCustomer)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].ClientCase.CurrentStatus)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].ClientCase.EscalationStatus)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].ClientCase.CreatedDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].Payment.FinalizedCost)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].Payment.PaymentReleased)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FullCaseInfo[0].Nudge)
            </th>
            <th>
                Navigate To
            </th>
            <th>
                PayInfo
            </th>

        </tr>
    </thead>
    <tbody>

        @foreach (var customerCase in Model.FullCaseInfo)
                {
        <tr>
            <td>
                @Html.DisplayFor(model => localizer[customerCase.ClientCase.Order.ServiceName].Value)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.ClientCase.Order.City)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.ClientCase.Order.CustomerEmail)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.ClientCase.Order.CustomerPhone)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.ClientCase.Order.Receipt)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.ClientCase.Order.ConsultantEmail)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.ClientCase.Order.ConsultantPhone)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.ClientCase.Order.CostToCustomer)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.ClientCase.CurrentStatus)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.ClientCase.EscalationStatus)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.ClientCase.CreatedDate)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.Payment.FinalizedCost)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.Payment.PaymentReleased)
            </td>
            <td>
                @Html.DisplayFor(model => customerCase.Nudge)
            </td>
            <td>
                <a asp-page="/Case/CaseDetail" class="btn btn-success btn-block" asp-route-rct="@customerCase.ClientCase.Order.Receipt">Details</a>
            </td>
            <td>
                <a asp-page="/Case/Fin" class="btn btn-success btn-block" asp-route-rct="@customerCase.ClientCase.Order.Receipt">Details</a>
            </td>

        </tr>

                }
    </tbody>
</table>



@section Scripts{


    <script src="~/datatables/jquery.dataTables.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#caseListSection").css("margin-top", $("#topnavbarbutnobeer").height() * 1.3);
        });
    </script>
    <script type="text/javascript" language="javascript" src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/dataTabless/DataTables-1.10.21/js/jquery.dataTables.min.js"></script>
    <script src="~/dataTabless/DataTables-1.10.21/js/dataTables.bootstrap4.min.js"></script>
    <script src="~/dataTabless/Responsive-2.2.5/js/responsive.bootstrap4.min.js"></script>
    <script src="~/dataTabless/FixedColumns-3.3.1/js/dataTables.fixedColumns.min.js"></script>

    <script>
        $(document).ready(function () {
            $('#caseList').DataTable({
                scrollY: "600px",
                scrollX: true,
                scrollCollapse: true,
                paging: true,
                columnDefs: [
                    { width: '20%', targets: 0 }
                ],
                fixedColumns: true,
                "rowCallback": function (row, data) {
                    if (data[13] == "NudgeOn") {
                        //$('td:eq(13)', row).html('<b>A</b>');
                        $('td', row).css('background-color', 'red');
                        //$('td', row).css('background-color', 'red');
                    }
                }
            });
        });
    </script>

}

